I"Ú<div class="tr_bq">Yesterday I came across another one of XPath's little quirks that cost me up to an hour of painstaking step-by-step troubleshooting to narrow down: comparing the value of a boolean element to one of the boolean functions (either true() or false()), also known as a subset of <a href="http://www.w3.org/TR/xpath/#booleans">boolean expressions</a>.</div>
<p><br />I had an element of type boolean buried in an XML document and my initial expression to test its value was like this:<br /><br />&lt;blockquote class="tr_bq"&gt;/path/to/boolean/element = true()&lt;/blockquote&gt;The expression is so simple and innocent-looking that (gasp!) there just couldnâ€™t be anything <i>wrong</i> with it. The path was expressed correctly, I was using the right operator and I wanted to see if the <u>boolean</u> element had a <u>boolean</u> value of true. Except, of course, it just didnâ€™t work as expected and the code just kept taking a wrong turn.<br /><br />I admit that I had previously seen this tested another way, namely like:<br />&lt;blockquote class="tr_bq"&gt;Â /path/to/boolean/element = â€˜trueâ€™&lt;/blockquote&gt;Notice how the comparison is now done against a <i>string</i> and not a boolean type. And it <i>works</i>. I thought it was just the engine or the specification trying to make life easier for programmers, some sort of condescending <i>youâ€™re doing it wrong but we understand what youâ€™re trying to accomplish here so weâ€™ll just run along with it</i> thing going on here. And why not believe that since, after all, at least some features of XPath were <a href="http://mukulgandhi.blogspot.com/2008/05/blog-post.html">catered to non-programmers</a>? So, me being me, I wanted to do it how I believed was the true, correctly <u>typed</u> way of course.<br /><br />And like I said, it doesnâ€™t work.<br /><br />If you go back to the link on boolean expressions youâ€™ll notice this line:<br /><br />&lt;blockquote class="tr_bq"&gt;If one object to be compared is a node-set and the other is a boolean, then the comparison will be true if and only if the result of performing the comparison on the boolean and on the result of converting the node-set to a boolean using the <b><a href="http://www.w3.org/TR/xpath/#function-boolean">boolean</a></b> function is true.&lt;/blockquote&gt;Â This is the scenario Iâ€™m talking about. Letâ€™s follow through the link to the <a href="http://www.w3.org/TR/xpath/#function-boolean">boolean</a> function:<br />&lt;blockquote class="tr_bq"&gt;Â The <b><a href="http://www.w3.org/TR/xpath/#function-boolean">boolean</a></b> function converts its argument to a boolean as follows:<br />&lt;blockquote class="tr_bq"&gt;&lt;ul&gt;&lt;li&gt;a node-set is true if and only if it is non-empty &lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;Mother of godâ€¦ My expression wasnâ€™t testing the value of my boolean element - it was checking to see if the result of my xpath returned any nodes at all! Gasp! Going back to the section on boolean expressions reveals this:<br /><br />&lt;blockquote&gt; If one object to be compared is a node-set and the other is a string, then the comparison will be true if and only if there is a node in the node-set such that the result of performing the comparison on the <a href="http://www.w3.org/TR/xpath/#dt-string-value">string-value</a> of the node and the other string is true.&lt;/blockquote&gt;So hold on a minuteâ€¦. work with me here. If I compare my xpath that selects a boolean element against a string then the actual <i>value</i> of said element is considered, but when I compare that same xpath against a boolean type then the actual value of the element is irrelevant?<br /><br />What insane world are we living in? What was the genius behind this design decision?</p>
:ET